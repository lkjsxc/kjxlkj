# File Size Audit

Source files exceeding 200 lines are listed here per project policy.
All files are now ≤ 200 lines.

## Current Audit (all clear)

| File | Lines | Status |
|------|-------|--------|
| `action.rs` (kjxlkj-core-types) | 131 | OK |
| `search.rs` (kjxlkj-core-state) | 191 | OK |
| `editor.rs` (kjxlkj-core-state) | 196 | OK |
| `editor_search_tests.rs` (kjxlkj-core-state) | 200 | OK |
| `normal.rs` (kjxlkj-core-mode) | 200 | OK |
| `other_modes.rs` (kjxlkj-core-mode) | 192 | OK |
| `motion_find.rs` (kjxlkj-core-edit) | 174 | OK |
| `editor_cmdline.rs` (kjxlkj-core-state) | 122 | OK |
| `layout_ops.rs` (kjxlkj-core-ui) | 191 | OK |
| `motion.rs` (kjxlkj-core-edit) | 200 | OK |
| `editor_edit.rs` (kjxlkj-core-state) | 199 | OK |
| `normal_g.rs` (kjxlkj-core-mode) | 165 | OK |
| `register.rs` (kjxlkj-core-state) | 198 | OK |
| `pending.rs` (kjxlkj-core-mode) | 181 | OK |
| `frame.rs` (kjxlkj-render) | 159 | OK |
| `command_parse.rs` (kjxlkj-core-state) | 155 | OK |
| `buffer.rs` (kjxlkj-core-text) | 156 | OK |
| `editor_ops.rs` (kjxlkj-core-state) | 195 | OK |
| `editor_ext.rs` (kjxlkj-core-state) | 144 | OK |
| `editor_action.rs` (kjxlkj-core-state) | 193 | OK |
| `regex_compile.rs` (kjxlkj-core-edit) | 120 | OK |
| `text_object.rs` (kjxlkj-core-edit) | 195 | OK |
| `text_object_ext.rs` (kjxlkj-core-edit) | 126 | OK |
| `editor_textobj_tests.rs` (kjxlkj-core-state) | 111 | OK |
| `editor_visual.rs` (kjxlkj-core-state) | 197 | OK |
| `editor_visual_tests.rs` (kjxlkj-core-state) | 139 | OK |
| `editor_buffer.rs` (kjxlkj-core-state) | 194 | OK |
| `editor_buffer_tests.rs` (kjxlkj-core-state) | 153 | OK |
| `editor_race_tests.rs` (kjxlkj-core-state) | 140 | OK |
| `editor_boundary_tests.rs` (kjxlkj-core-state) | 83 | OK |
| `editor_stage03_tests.rs` (kjxlkj-core-state) | 134 | OK |
| `editor_stage03_edit_tests.rs` (kjxlkj-core-state) | 108 | OK |
| `editor_wincmd_tests.rs` (kjxlkj-core-state) | 144 | OK |
| `editor_window.rs` (kjxlkj-core-state) | 176 | OK |
| `editor_explorer.rs` (kjxlkj-core-state) | 170 | OK |
| `normal_wincmd.rs` (kjxlkj-core-mode) | 171 | OK |
| `lib.rs` (kjxlkj-core-state) | 77 | OK |
| `lib.rs` (kjxlkj-core-mode) | 147 | OK |
| `layout_resize.rs` (kjxlkj-core-ui) | 127 | OK |
| `editor_stage04_tests.rs` (kjxlkj-core-state) | 189 | OK |
| `editor_stage04b_tests.rs` (kjxlkj-core-state) | 168 | OK |
| `editor_stage04c_tests.rs` (kjxlkj-core-state) | 193 | OK |
| `lib.rs` (kjxlkj-service-explorer) | 126 | OK |
| `explorer_state_tests.rs` (kjxlkj-service-explorer) | 87 | OK |
| `explorer_tree.rs` (kjxlkj-service-explorer) | 95 | OK |
| `explorer_nav.rs` (kjxlkj-service-explorer) | 181 | OK |
| `lib.rs` (kjxlkj-service-terminal) | 81 | OK |
| `navlist.rs` (kjxlkj-core-state) | 128 | OK |
| `editor_nav.rs` (kjxlkj-core-state) | 157 | OK |
| `editor_stage04d_tests.rs` (kjxlkj-core-state) | 151 | OK |
| `marks.rs` (kjxlkj-core-state) | 88 | OK |
| `editor_stage04e_tests.rs` (kjxlkj-core-state) | 130 | OK |
| `normal_partial.rs` (kjxlkj-core-mode) | 115 | OK |
| `macros.rs` (kjxlkj-core-state) | 133 | OK |
| `editor_stage04f_tests.rs` (kjxlkj-core-state) | 190 | OK |
| `normal_z.rs` (kjxlkj-core-mode) | 115 | OK |
| `folds.rs` (kjxlkj-core-state) | 184 | OK |
| `editor_stage04g_tests.rs` (kjxlkj-core-state) | 169 | OK |
| `escape_parser.rs` (kjxlkj-service-terminal) | 170 | OK |
| `csi.rs` (kjxlkj-service-terminal) | 98 | OK |
| `parser_tests.rs` (kjxlkj-service-terminal) | 51 | OK |
| `screen.rs` (kjxlkj-service-terminal) | 177 | OK |
| `screen_tests.rs` (kjxlkj-service-terminal) | 46 | OK |
| `filetype.rs` (kjxlkj-service-index) | 81 | OK |
| `lib.rs` (kjxlkj-service-index) | 12 | OK |
| `lifecycle.rs` (kjxlkj-service-lsp) | 130 | OK |
| `diagnostic.rs` (kjxlkj-service-lsp) | 177 | OK |
| `lib.rs` (kjxlkj-service-lsp) | 13 | OK |
| `theme.rs` (kjxlkj-core-ui) | 156 | OK |
| `statusline.rs` (kjxlkj-core-ui) | 178 | OK |
| `messages.rs` (kjxlkj-core-ui) | 182 | OK |
| `gitsigns.rs` (kjxlkj-service-git) | 159 | OK |
| `gitsigns_tests.rs` (kjxlkj-service-git) | 75 | OK |
| `lib.rs` (kjxlkj-service-git) | 14 | OK |
| `viewport.rs` (kjxlkj-core-ui) | 156 | OK |
| `viewport_tests.rs` (kjxlkj-core-ui) | 64 | OK |
| `float_win.rs` (kjxlkj-core-ui) | 146 | OK |
| `float_win_tests.rs` (kjxlkj-core-ui) | 72 | OK |
| `statusline_dsl.rs` (kjxlkj-core-ui) | 114 | OK |
| `statusline_dsl_tests.rs` (kjxlkj-core-ui) | 89 | OK |
| `tabs.rs` (kjxlkj-core-ui) | 104 | OK |
| `tabs_tests.rs` (kjxlkj-core-ui) | 94 | OK |
| `zoom.rs` (kjxlkj-core-ui) | 87 | OK |
| `zoom_tests.rs` (kjxlkj-core-ui) | 67 | OK |
| `mode_config.rs` (kjxlkj-core-ui) | 140 | OK |
| `completion.rs` (kjxlkj-core-ui) | 114 | OK |
| `completion_tests.rs` (kjxlkj-core-ui) | 92 | OK |
| `editor_cmdline_tests.rs` (kjxlkj-core-state) | 145 | OK |
| `insert_state.rs` (kjxlkj-core-ui) | 170 | OK |
| `snippet.rs` (kjxlkj-core-ui) | 184 | OK |
| `digraph.rs` (kjxlkj-core-ui) | 119 | OK |
| `editor_stage05_tests.rs` (kjxlkj-core-state) | 135 | OK |
| `lib.rs` (kjxlkj-core-ui) | 27 | OK |

## Splits Performed

| Original | Lines | Split Into |
|----------|-------|------------|
| `editor.rs` | 499 | `editor.rs` (155), `editor_action.rs` (82), `editor_edit.rs` (151), `editor_snapshot.rs` (125), `editor_window.rs` (65) |
| `layout.rs` | 322 | `layout.rs` (149), `layout_ops.rs` (191) |
| `normal.rs` | 240 | `normal.rs` (190), `normal_motions.rs` (95) |
| `motion.rs` | 220 | `motion.rs` (190), `motion_word.rs` (147), `motion_find.rs` (196), `motion_big_word.rs` (100) |
| `buffer.rs` | 206 | `buffer.rs` (129), `buffer_edit.rs` (91) |
| `lib.rs` (core-mode) | 267 | `lib.rs` (146), `normal_partial.rs` (85), `other_modes.rs` (168) |

## Notes

- All source files now comply with the ≤ 200 line policy.
- Monitor `editor.rs` (196), `motion.rs` (200), `normal.rs` (200), `editor_search_tests.rs` (200), `editor_edit.rs` (199), `register.rs` (198), `editor_visual.rs` (197), `text_object.rs` (195), `editor_ops.rs` (195), `editor_buffer.rs` (194), `editor_stage04c_tests.rs` (193), `editor_action.rs` (193), `other_modes.rs` (192), `layout_ops.rs` (191), `editor_stage04f_tests.rs` (190), `editor_stage04_tests.rs` (189), `LIMITATIONS.md` (195), `snippet.rs` (184), `folds.rs` (184), `messages.rs` (182), `explorer_nav.rs` (181), `statusline.rs` (178), `screen.rs` (177), `diagnostic.rs` (177), `editor_window.rs` (176), `wave-progress.md` (174), `escape_parser.rs` (170), `insert_state.rs` (170), `gitsigns.rs` (159), `theme.rs` (156), `viewport.rs` (156), `command_parse.rs` (155) as they approach the limit.
- New files added in wave-017: `motion_info.rs` (98), `editor_ext.rs` (144).
- New files added in wave-018: `register.rs` (140→176), `pending.rs` expanded to 175.
- New files added in wave-019: `regex_compile.rs` (187→120 refactored), `command_parse.rs` (159), `search.rs` (200), `editor_cmdline.rs` (195).
- Wave-020 changes: `regex_compile.rs` refactored to 120, `editor_edit.rs` 151→179, `register.rs` 140→176, `editor_ops.rs` 152, `editor_action.rs` 132.
- Wave-021 changes: `register.rs` 176→198, `editor.rs` 200→186, `editor_cmdline.rs` 195→150, `action.rs` 200→197, `command_parse.rs` 159→169, `editor_action.rs` 132→138.
- Wave-022 changes: `search.rs` 200→177 (helpers extracted to `search_util.rs`), `action.rs` 197→200, `normal.rs` 199→198, `command_parse.rs` 169→177, `editor_action.rs` 138→159, `editor.rs` 186→185. New files: `search_util.rs` (73), `editor_search_tests.rs` (105).
- Wave-023 changes: `search.rs` 177→191 (+history, ignorecase/smartcase, compacted tests), `action.rs` 200→200 (added GStarSearchForward/GStarSearchBackward, removed 4 doc comments), `normal_g.rs` 177→197 (+g*/g# dispatch, 2 new tests), `motion_find.rs` 196→174 (compacted paragraphs, bracket_pair helper, % forward scan), `motion.rs` 190→200 (+% forward scan test), `editor_action.rs` 159→177 (+g_star_search dispatch), `editor_search_tests.rs` 137→191 (+5 integration tests: g*, g#, %, history, ignorecase).
- Wave-024 changes: `command_parse.rs` 177→199 (+parse_set_option, +test), `editor_action.rs` 177→189 (+IncrementNumber/DecrementNumber/SetOption dispatch, +apply_set_option), `editor_edit.rs` 179→199 (+increment_number/decrement_number/modify_number, +find_number, compacted cursor/clamp), `editor_search_tests.rs` 191→200 (merged star boundary tests, +ctrl_a_increments_number, +set_option_via_ex_command), `normal.rs` 198→200 (+Ctrl-a/Ctrl-x).
- Wave-025 changes: `action.rs` 200→194 (removed comments, compacted scrolls, +TextObjInner/TextObjAround), `pending.rs` 175→179 (+TextObjectInner/TextObjectAround), `other_modes.rs` 196→142 (full rewrite: compacted all handlers, +text object dispatch), `editor_ops.rs` 152→186 (+apply_operator_text_obj, +text object branch). New files: `text_object.rs` (199, word/bracket/quote range computation, 7 tests), `editor_textobj_tests.rs` (90, 7 integration tests).
- Wave-026 changes: `text_object.rs` 199→195 (merged word tests, +p/s dispatch to text_object_ext), `editor_textobj_tests.rs` 90→111 (+dip/dis integration tests). New file: `text_object_ext.rs` (126, paragraph/sentence range computation, 5 unit tests).
- Wave-027 changes: `action.rs` 194→198 (+VisualOperator/VisualSwapAnchor), `editor.rs` 185→200 (+visual_anchor, visual lifecycle, compacted doc comment), `other_modes.rs` 142→184 (expanded handle_visual_key), `editor_action.rs` 189→191 (+VisualOperator/VisualSwapAnchor wiring). New files: `editor_visual.rs` (197, visual operator dispatch, 2 unit tests), `editor_visual_tests.rs` (139, 11 integration tests).
- Wave-028 changes: `action.rs` 198→199 (+SwitchAlternate/ListBuffers, removed 3 doc comments), `command_parse.rs` 199→200 (+:ls/:buffers, compacted doc), `editor.rs` 200→200 (+alternate_buffer, compacted comments), `editor_action.rs` 191→198 (+buffer action dispatch), `normal.rs` 200→200 (+Ctrl-6/^ mapping, merged wildcard). New file: `editor_buffer.rs` (182, buffer management, 5 unit tests).
- Wave-029 changes: `action.rs` 199→200 (+FirstBuffer/LastBuffer on single line), `command_parse.rs` 200→194 (+:bf/:bfirst/:bl/:blast, merged 3 tests into 1 for compaction), `editor_buffer.rs` 182→194 (+first_buffer/last_buffer), `editor_action.rs` 198→200 (+FirstBuffer/LastBuffer dispatch). New file: `editor_buffer_tests.rs` (153, 13 integration tests).
- Wave-030 changes: No existing files modified (test-only wave). New files: `editor_race_tests.rs` (140, 10 stress tests), `editor_boundary_tests.rs` (83, 7 boundary safety tests), `lib.rs` (core-state) 43→47 (+2 test modules).
- Wave-031 changes: `lib.rs` (core-state) 47→51 (+2 test modules). New files: `editor_stage03_tests.rs` (134, 7 stage-03 exit tests), `editor_stage03_edit_tests.rs` (108, 5 stage-03 edit tests). Original single file (215 lines) split to comply with ≤ 200 policy.
- Wave-032 changes: `pending.rs` 179→181 (+WinCmd variant), `normal.rs` 200→200 (compacted tests, +Ctrl-w dispatch), `normal_partial.rs` 91→93 (+WinCmd arm), `editor_action.rs` 200→186 (compacted dispatchers, +4 window actions), `editor_window.rs` 65→128 (+window_only/focus_cycle/focus_direction), `lib.rs` (core-mode) 146→147 (+normal_wincmd), `lib.rs` (core-state) 51→53 (+editor_wincmd_tests). New files: `normal_wincmd.rs` (87, wincmd key dispatch, 7 tests), `editor_wincmd_tests.rs` (144, 12 integration tests).
- Wave-033 changes: `action.rs` 200→112 (massive compaction: removed per-variant doc comments, grouped variants on shared lines), `normal_wincmd.rs` 87→137 (+10 dispatch arms, +8 tests), `editor_window.rs` 128→150 (+focus_top_left/focus_bottom_right/equalize/resize/max/open_explorer/close_explorer, compacted with leaf_rects helper), `editor_action.rs` 186→194 (+8 dispatch arms), `command_parse.rs` 194→195 (+ExplorerClose), `lib.rs` (core-state) 53→55 (+editor_stage04_tests). New files: `layout_resize.rs` (127, equalize/axis helpers, 3 tests), `editor_stage04_tests.rs` (189, 14 integration tests).
- Wave-034 changes: `editor.rs` 200→183 (added explorer_states HashMap, explorer key interception, compacted struct comments and tests), `editor_window.rs` 150→157 (proper ExplorerState creation/cleanup in open/close), `lib.rs` (core-state) 55→58 (+editor_explorer, +editor_stage04b_tests). New files: `editor_explorer.rs` (123, explorer key routing, 5 tests), `editor_stage04b_tests.rs` (168, 13 integration tests), `lib.rs` (kjxlkj-service-explorer) rewritten from stub (197, ExplorerState model, 4 tests), `explorer_tree.rs` (95, ExplorerNode tree model, 3 tests), `explorer_nav.rs` (181, navigation actions, 5 tests), `lib.rs` (kjxlkj-service-terminal) expanded from stub (77, TerminalState model, 2 tests).
- Wave-035 changes: `action.rs` 112→113 (+FocusCycleReverse/WindowMoveEdge/WindowRotate/WindowExchange), `normal_wincmd.rs` 137→171 (+9 dispatch arms, +6 tests), `editor_action.rs` 194→199 (+5 dispatch arms), `editor_window.rs` 157→176 (+focus_cycle_reverse, +open_terminal), `editor_explorer.rs` 123→170 (enhanced with ExplorerKeyResult enum, +v/s split-open keys), `lib.rs` (kjxlkj-service-explorer) 197→126 (tests extracted to explorer_state_tests.rs), `lib.rs` (core-state) 58→60 (+editor_stage04c_tests). New files: `editor_stage04c_tests.rs` (193, 14 integration tests), `explorer_state_tests.rs` (87, 5 extracted tests + 1 new).
- Wave-036 changes: `action.rs` 113→114 (+JumpOlder/JumpNewer/ChangeOlder/ChangeNewer), `normal.rs` 200→200 (compacted tests, +Ctrl-o/Ctrl-i dispatch, +2 tests), `normal_g.rs` 197→165 (all tests to inline format, +g;/g, dispatch, +2 tests), `editor.rs` 183→200 (+jumplist/changelist fields, +is_jump_action, +record_jump/record_change), `editor_action.rs` 199→191 (compacted single-statement arms, +JumpOlder/JumpNewer/ChangeOlder/ChangeNewer dispatch), `lib.rs` (core-state) 60→64 (+navlist, +editor_nav, +editor_stage04d_tests). New files: `navlist.rs` (128, PositionList data structure, 6 tests), `editor_nav.rs` (70, navigate_jumplist/navigate_changelist/record_jump/record_change), `editor_stage04d_tests.rs` (151, 16 boundary tests).
- Wave-037 changes: `action.rs` 114→115 (+SetMark/GotoMarkLine/GotoMarkExact), `normal.rs` 200→198 (+'→GotoMarkLine, +`→GotoMarkExact, merged Escape/_ arms), `normal_partial.rs` 93→108 (+SetMark/GotoMarkLine/GotoMarkExact emit real actions), `editor.rs` 200→200 (+marks: MarkStore field, compacted constructor), `editor_action.rs` 191→194 (+SetMark/GotoMarkLine/GotoMarkExact dispatch), `editor_nav.rs` 70→115 (+set_mark_at_cursor/goto_mark_line/goto_mark_exact), `lib.rs` (core-state) 64→67 (+marks, +editor_stage04e_tests). New files: `marks.rs` (88, MarkStore, 5 tests), `editor_stage04e_tests.rs` (130, 12 integration tests).
- Wave-038 changes: `action.rs` 115→116 (+MacroRecordStart/MacroRecordStop/MacroPlay), `normal.rs` 198→200 (+q→MacroRecord, +@→MacroPlay), `normal_partial.rs` 108→115 (MacroRecord/MacroPlay emit real actions), `editor.rs` 200→194 (compacted imports/struct/comments, +macro_state field, +stop-q intercept, +capture call), `editor_action.rs` 194→197 (+MacroRecordStart/MacroRecordStop/MacroPlay dispatch), `editor_nav.rs` 115→171 (+start/stop_macro_recording, +play_macro, +parse_macro_keys), `lib.rs` (core-state) 67→70 (+macros, +editor_stage04f_tests). New files: `macros.rs` (133, MacroState, 5 tests), `editor_stage04f_tests.rs` (190, 15 integration tests). Wave-progress.md split: waves 032-034 archived to wave-progress-stage-04-early.md.
- Wave-039 changes: `action.rs` 116→119 (+9 fold variants), `normal_z.rs` 43→115 (+zo/zc/za/zR/zM/zr/zm/zj/zk dispatch, +9 unit tests), `editor.rs` 194→196 (+fold_state field), `editor_action.rs` 197→184 (+fold dispatch, compacted existing arms), `editor_nav.rs` 171→157 (+fold methods, +apply_nav_position shared helper, refactored and compacted), `lib.rs` (core-state) 70→73 (+folds, +editor_stage04g_tests). New files: `folds.rs` (184, FoldState, 6 tests), `editor_stage04g_tests.rs` (169, 16 integration tests).
- Wave-040 changes: `lib.rs` (kjxlkj-service-terminal) 77→81 (+pub mod csi/escape_parser/screen), `lib.rs` (kjxlkj-service-index) 11→12 (+pub mod filetype). New files: `escape_parser.rs` (170, VT100 parser core), `csi.rs` (98, CSI dispatch + SGR), `parser_tests.rs` (51, 6 parser tests), `screen.rs` (177, cell grid model), `screen_tests.rs` (46, 5 screen tests), `filetype.rs` (81, 15-language detection, 20 tests).
- Wave-041 changes: `lib.rs` (kjxlkj-service-lsp) 9→13 (+pub mod diagnostic; +pub mod lifecycle;), `lib.rs` (kjxlkj-core-ui) 10→12 (+pub mod theme;). New files: `lifecycle.rs` (130, LSP lifecycle state machine, 5 tests), `diagnostic.rs` (177, diagnostic data model, 8 tests), `theme.rs` (156, highlight/theme model, 7 tests).
- Wave-042 changes: `lib.rs` (kjxlkj-service-git) 11→14 (+pub mod gitsigns;), `lib.rs` (kjxlkj-core-ui) 12→14 (+pub mod statusline; +pub mod messages;). New files: `gitsigns.rs` (159, git sign state model, tests extracted), `gitsigns_tests.rs` (75, 7 tests), `statusline.rs` (178, statusline data model, 7 tests), `messages.rs` (182, message/notification model, 8 tests).
- Wave-043 changes: `lib.rs` (kjxlkj-core-ui) 14→17 (+pub mod viewport; +pub mod float_win; +pub mod statusline_dsl;). New files: `viewport.rs` (156, viewport state model, tests extracted), `viewport_tests.rs` (64, 8 tests), `float_win.rs` (146, floating window model, tests extracted), `float_win_tests.rs` (72, 7 tests), `statusline_dsl.rs` (114, DSL parser and renderer, tests extracted), `statusline_dsl_tests.rs` (89, 8 tests).
- Wave-044 changes: `action.rs` 119→125 (+11 tab/zoom variants), `command_parse.rs` 195→155 (compacted + tab/zoom commands), `editor_action.rs` 184→189 (+tab/zoom dispatch), `lib.rs` (core-ui) 17→19 (+pub mod tabs; +pub mod zoom;). New files: `tabs.rs` (104, tab page model), `tabs_tests.rs` (94, 11 tests), `zoom.rs` (87, zoom state), `zoom_tests.rs` (67, 7 tests).
- Wave-045 changes: `editor_cmdline.rs` 150→122 (tests extracted, +cmdline editing keys), `lib.rs` (core-ui) 19→24 (+mode_config, +completion, +completion_tests), `lib.rs` (core-state) 73→75 (+editor_cmdline_tests). New files: `mode_config.rs` (140, cursor shapes/mode indicator), `completion.rs` (114, completion model), `completion_tests.rs` (92, 11 tests), `editor_cmdline_tests.rs` (145, 13 tests).
- Wave-046 changes: `action.rs` 125→131 (+6 completion/insert variants), `other_modes.rs` 184→192 (+completion keys in insert), `editor_action.rs` 189→193 (+InsertDigraph/InsertLiteral/InsertRegister, compacted), `editor_ops.rs` 186→195 (+insert_register_contents), `lib.rs` (core-ui) 24→27, `lib.rs` (core-state) 75→77. New files: `insert_state.rs` (170, insert sub-state machine), `snippet.rs` (184, snippet session), `digraph.rs` (119, RFC 1345 table), `editor_stage05_tests.rs` (135, 12 integration tests).
