openapi: 3.0.3
info:
  title: kjxlkj API
  version: 2026-02-15
servers:
  - url: /api
paths:
  /auth/session:
    get:
      summary: Get current session
      responses:
        '200':
          description: Session payload
        '401':
          description: Unauthenticated
  /notes:
    post:
      summary: Create note (defaults title to current datetime when omitted)
      responses:
        '201':
          description: Note created
        '422':
          description: Validation failure
    get:
      summary: List notes
      responses:
        '200':
          description: Note list
  /notes/{id}:
    get:
      summary: Get note projection
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Note projection
        '404':
          description: Not found
    patch:
      summary: Patch note with optimistic versioning
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Note updated
        '409':
          description: Version conflict
  /search:
    get:
      summary: Hybrid lexical+semantic search
      parameters:
        - in: query
          name: q
          required: true
          schema:
            type: string
        - in: query
          name: mode
          required: false
          schema:
            type: string
            enum: [hybrid, lexical, semantic]
      responses:
        '200':
          description: Search results
        '422':
          description: Invalid mode
  /automation/rules:
    get:
      summary: List automation rules
      responses:
        '200':
          description: Rule list
    post:
      summary: Create automation rule (`kjxlkj_agent` supported)
      responses:
        '201':
          description: Rule created
        '422':
          description: Invalid rule payload
  /automation/rules/{id}/launch:
    post:
      summary: Launch automation run
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '202':
          description: Run launched
  /automation/runs/{id}:
    get:
      summary: Get automation run status
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Run status
components: {}
