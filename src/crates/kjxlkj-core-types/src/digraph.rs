//! Digraph lookup: two-char sequences to Unicode characters.

/// Look up a digraph from two characters.
pub fn digraph_lookup(c1: char, c2: char) -> Option<char> {
    // Also try reverse order for convenience
    lookup(c1, c2).or_else(|| lookup(c2, c1))
}

fn lookup(c1: char, c2: char) -> Option<char> {
    DIGRAPHS.iter().find(|&&(a, b, _)| a == c1 && b == c2).map(|e| e.2)
}

/// Built-in digraph table (subset of Vim's digraphs).
static DIGRAPHS: &[(char, char, char)] = &[
    // Accented characters
    ('a', '\'', 'á'), ('e', '\'', 'é'), ('i', '\'', 'í'),
    ('o', '\'', 'ó'), ('u', '\'', 'ú'),
    ('A', '\'', 'Á'), ('E', '\'', 'É'), ('I', '\'', 'Í'),
    ('O', '\'', 'Ó'), ('U', '\'', 'Ú'),
    ('a', '!', 'à'), ('e', '!', 'è'), ('i', '!', 'ì'),
    ('o', '!', 'ò'), ('u', '!', 'ù'),
    ('a', '>', 'â'), ('e', '>', 'ê'), ('i', '>', 'î'),
    ('o', '>', 'ô'), ('u', '>', 'û'),
    ('a', ':', 'ä'), ('e', ':', 'ë'), ('i', ':', 'ï'),
    ('o', ':', 'ö'), ('u', ':', 'ü'),
    ('a', '~', 'ã'), ('n', '~', 'ñ'), ('o', '~', 'õ'),
    ('A', ':', 'Ä'), ('O', ':', 'Ö'), ('U', ':', 'Ü'),
    ('s', 's', 'ß'),
    // Currency
    ('E', 'u', '€'), ('P', 'd', '£'), ('Y', 'e', '¥'), ('C', 't', '¢'),
    // Math
    ('+', '-', '±'), ('*', 'X', '×'), ('-', ':', '÷'),
    ('!', '=', '≠'), ('=', '<', '≤'), ('>', '=', '≥'),
    ('0', '0', '∞'),
    // Greek
    ('a', '*', 'α'), ('b', '*', 'β'), ('g', '*', 'γ'),
    ('d', '*', 'δ'), ('p', '*', 'π'), ('s', '*', 'σ'),
    ('l', '*', 'λ'), ('m', '*', 'μ'), ('t', '*', 'τ'),
    ('f', '*', 'φ'), ('w', '*', 'ω'),
    // Arrows
    ('-', '>', '→'), ('<', '-', '←'), ('-', 'v', '↓'),
    ('-', '!', '↑'), ('<', '>', '↔'), ('=', '>', '⇒'),
    // Punctuation
    ('.', '.', '…'), ('-', '-', '–'),
    ('<', '<', '«'), ('>', '>', '»'),
    ('!', '!', '¡'), ('?', '?', '¿'),
    // Fractions
    ('1', '2', '½'), ('1', '4', '¼'), ('3', '4', '¾'),
    // Box drawing
    ('v', 'v', '│'), ('h', 'h', '─'),
    ('d', 'r', '┌'), ('d', 'l', '┐'),
    ('u', 'r', '└'), ('u', 'l', '┘'),
    // Misc
    ('c', 'O', '©'), ('R', 'g', '®'), ('T', 'M', '™'),
    ('D', 'G', '°'), ('M', 'y', 'µ'),
    ('N', 'o', '№'), ('P', 'I', '¶'), ('S', 'E', '§'),
];
